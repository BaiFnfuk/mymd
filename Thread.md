## Thread

### 1. process 与 thread

1. 进程是程序的一次执行过程，它是一个动态概念。是系统资源分配的单位
2. 通常在一个进程中可以包含若干个线程，当然一个进程中至少有一个线程，不然没有存在的意义。线程是CPU调试和执行的单位 

`注意：很多多线程是模拟出来的，真正的多线程是指有多个cpu,即多核，如服务器。如果是模拟出来的多线程，即在一个cpu的情况下，在同一个时间点，cpu只能执行一个代码，因为切换的很快，所以就有同时执行的错觉。`

**本章核心概念**

- 线程就是独立的执行路径
- 在程序运行时，即使没有自己创建线程，后台也会有多个线程，如主线程，gc线程;
- main()称之为主线程，为系统的入口，用于执行整个程序
- 在一个进程中，如果开开辟了多个线程，线程的运行由调试器安排调度，调度器是与操作系统紧密相关的，先后顺序是不能人为的干预的。
- 对同一份资源操作时，会存在资源抢夺的问题，需要加入并发控制;
- 线程会带来额外的开销，如CPU调度时间，并发控制开销。
- 每个线程在自己的工作内存交互，内存控制不当会造成数据不一致。 

### 2. 线程创建

1. 继承Thread类（重点），不推荐使用，单继承的局限性
2. 实现Runnable接口（重点），推荐使用，灵活方便，避免单继承局限性
3. 实现Callable接口（了解）

### 3.并发问题

1. 多个线程同时访问同一资源时会出现问题

sleep（）不会释放锁。

yield(), 礼让，当前线程暂停，让别的线程执行。不一定成功，看cpu调度

join(),待此线程执行完成后，再执行其他线程，其他线程阻塞，可以理解为插队

### 4.守护线程

- 线程分为用户线程和守护线程
- 虚拟机必须确保用户线程执行完毕
- 虚拟机不用等待守护线程执行完毕
- 如，后台记录操作日志，监控内存，垃圾回收等。。。

- domane()

### 线程同步

并发： 同一个对象被多个线程同时操作（抢票）

同步： 同一个对象每次只能被一个线程操作

同步条件：队列+锁

synchronized关键字

锁存在的问题

- 一个线程持有锁会导致其他所有需要此锁的线程挂起
- 在多个线程竞争下，加锁，释放锁会导致比较多的上下文切换和调度延时，引起性能问题
- 如果一个优先张高的线程等待一个优先级低的线程释放锁会导致优先级倒置，引起性能问题



